# LeetCode 1266 - 拜訪所有點的最小時間

> **難度：** 簡單  
> **主題：** 陣列、數學、幾何  
> **相關概念：** 切比雪夫距離（Chebyshev Distance）

## 題目描述

在 2D 平面上，有 n 個整數座標的點 `points[i] = [xi, yi]`。請回傳按給定順序拜訪所有點所需的最少秒數。

每秒可以進行以下其中一種移動：
- **垂直移動**一個單位（上下）
- **水平移動**一個單位（左右）
- **對角線移動**（同時水平與垂直各移動一個單位，耗時 1 秒）

> [!IMPORTANT]
> 必須依照陣列中的順序拜訪點；你可以經過在後方出現的點，但不算作拜訪。

### 範例

**範例 1：**
```
輸入：points = [[1,1],[3,4],[-1,0]]
輸出：7
說明：
- 從 [1,1] 移動到 [3,4]：沿對角線移動 2 秒，再垂直移動 1 秒，共 3 秒
- 從 [3,4] 移動到 [-1,0]：沿對角線移動 4 秒，共 4 秒
- 總時間：3 + 4 = 7 秒
```

**範例 2：**
```
輸入：points = [[3,2],[-2,2]]
輸出：5
說明：
- 從 [3,2] 移動到 [-2,2]：水平移動 5 秒
```

### 限制條件

- `points.length == n`
- `1 <= n <= 100`
- `points[i].length == 2`
- `-1000 <= points[i][0], points[i][1] <= 1000`

## 解題概念與出發點

### 問題分析

這題的關鍵在於理解**移動規則**：
1. 每秒可以水平、垂直或對角線移動一個單位
2. 對角線移動相當於同時進行水平和垂直移動，但只消耗 1 秒
3. 必須按順序拜訪所有點

### 核心思路

假設我們要從點 `(x₁, y₁)` 移動到點 `(x₂, y₂)`：

- **水平距離**：`dx = |x₁ - x₂|`
- **垂直距離**：`dy = |y₁ - y₂|`

當 `dx` 和 `dy` 都大於 0 時：
- 使用**對角線移動**，一秒就能把 `dx` 和 `dy` 都減少 1（最優選擇）
- 其他移動方式，一秒只能把 `dx` 或 `dy` 的其中一個減少 1

### 移動策略

1. **若 `dx > dy`**：
   - 先沿對角線移動 `dy` 秒（此時垂直距離歸零）
   - 再水平移動 `dx - dy` 秒
   - **總時間：`dx` 秒**

2. **若 `dx ≤ dy`**：
   - 先沿對角線移動 `dx` 秒（此時水平距離歸零）
   - 再垂直移動 `dy - dx` 秒
   - **總時間：`dy` 秒**

### 結論

從點 `(x₁, y₁)` 移動到點 `(x₂, y₂)` 的最少時間為：

```
時間 = max(dx, dy) = max(|x₁ - x₂|, |y₁ - y₂|)
```

這正是兩點之間的**切比雪夫距離**！

## 解法說明

### 演算法步驟

1. 初始化起點座標 `(x₀, y₀)` 為第一個點
2. 遍歷所有點，計算相鄰點對之間的切比雪夫距離
3. 累加所有距離，得到總時間

### 程式碼實作

```csharp
public int MinTimeToVisitAllPoints(int[][] points)
{
    // 初始化起點座標
    int x0 = points[0][0];
    int y0 = points[0][1];
    int res = 0;
    
    // 遍歷所有點，計算相鄰點對之間的切比雪夫距離
    for (int i = 0; i < points.Length; i++)
    {
        int x1 = points[i][0];
        int y1 = points[i][1];
        
        // 計算兩點間的切比雪夫距離
        res += Math.Max(Math.Abs(x1 - x0), Math.Abs(y1 - y0));
        
        // 更新當前位置為下一次迭代的起點
        x0 = x1;
        y0 = y1;
    }
    
    return res;
}
```

### 複雜度分析

- **時間複雜度：** `O(n)`，其中 n 是點的數量。需要遍歷所有點一次。
- **空間複雜度：** `O(1)`，僅使用常數額外空間。

## 範例演示流程

### 範例 1：`points = [[1,1],[3,4],[-1,0]]`

#### 步驟 1：從 `[1,1]` 移動到 `[3,4]`
```
dx = |3 - 1| = 2
dy = |4 - 1| = 3
時間 = max(2, 3) = 3 秒

移動路徑：
[1,1] → [2,2] → [3,3] → [3,4]
  對角線    對角線    垂直
```

#### 步驟 2：從 `[3,4]` 移動到 `[-1,0]`
```
dx = |-1 - 3| = 4
dy = |0 - 4| = 4
時間 = max(4, 4) = 4 秒

移動路徑：
[3,4] → [2,3] → [1,2] → [0,1] → [-1,0]
  對角線   對角線   對角線   對角線
```

#### 總結
```
總時間 = 3 + 4 = 7 秒
```

### 範例 2：`points = [[3,2],[-2,2]]`

#### 步驟 1：從 `[3,2]` 移動到 `[-2,2]`
```
dx = |-2 - 3| = 5
dy = |2 - 2| = 0
時間 = max(5, 0) = 5 秒

移動路徑：
[3,2] → [2,2] → [1,2] → [0,2] → [-1,2] → [-2,2]
  水平    水平    水平    水平     水平
```

#### 總結
```
總時間 = 5 秒
```

## 補充說明：切比雪夫距離

### 什麼是切比雪夫距離？

**切比雪夫距離**（Chebyshev Distance），又稱**棋盤距離**，是數學中用來測量兩點之間距離的一種度量方式。

在二維平面上，點 `(x₁, y₁)` 和 `(x₂, y₂)` 之間的切比雪夫距離定義為：

```
D_chebyshev = max(|x₁ - x₂|, |y₁ - y₂|)
```

### 為什麼叫「棋盤距離」？

想像在國際象棋的棋盤上，**國王**可以往八個方向移動（上、下、左、右、四個對角線）。從一個格子移動到另一個格子所需的最少步數，就是這兩個格子之間的切比雪夫距離。

### 與其他距離度量的比較

| 距離類型 | 公式 | 特點 |
|---------|------|------|
| **歐幾里得距離** | `√[(x₁-x₂)² + (y₁-y₂)²]` | 直線距離（鳥飛的距離） |
| **曼哈頓距離** | `|x₁-x₂| + |y₁-y₂|` | 只能水平或垂直移動（計程車距離） |
| **切比雪夫距離** | `max(|x₁-x₂|, |y₁-y₂|)` | 可以對角線移動（國王移動） |

### 實際應用

1. **遊戲開發**：計算棋類遊戲中棋子的移動距離
2. **圖像處理**：計算像素之間的最大差異
3. **機器學習**：作為一種距離度量用於聚類演算法
4. **路徑規劃**：在允許對角線移動的網格中尋找最短路徑

### 切比雪夫距離與曼哈頓距離的關係

有趣的是，切比雪夫距離可以通過座標旋轉轉換為曼哈頓距離：

```
D_chebyshev(P₁, P₂) = D_manhattan((x₁+y₁, x₁-y₁), (x₂+y₂, x₂-y₂)) / 2
```

這個性質在某些演算法優化中非常有用。

## 延伸思考

1. **如果只能垂直或水平移動（不能對角線），答案會是什麼？**
   - 答案會變成曼哈頓距離：`|x₁ - x₂| + |y₁ - y₂|`

2. **如果可以任意順序拜訪點，如何找到最短路徑？**
   - 這會變成**旅行推銷員問題**（TSP），是 NP-hard 問題

3. **如果對角線移動需要 √2 秒，答案會是什麼？**
   - 答案會接近歐幾里得距離

## 參考連結

- [LeetCode 原題（英文）](https://leetcode.com/problems/minimum-time-visiting-all-points/)
- [LeetCode 原題（中文）](https://leetcode.cn/problems/minimum-time-visiting-all-points/)
- [切比雪夫距離 - 維基百科](https://zh.wikipedia.org/wiki/%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E8%B7%9D%E7%A6%BB)

---

**標籤：** `陣列` `數學` `幾何` `切比雪夫距離`
