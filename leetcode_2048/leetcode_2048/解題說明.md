# LeetCode 2048: Next Greater Numerically Balanced Number

> 下一個更大的數值平衡數

[![LeetCode](https://img.shields.io/badge/LeetCode-2048-FFA116?logo=leetcode)](https://leetcode.com/problems/next-greater-numerically-balanced-number/)
[![Difficulty](https://img.shields.io/badge/Difficulty-Medium-orange)](https://leetcode.com/problems/next-greater-numerically-balanced-number/)
[![Language](https://img.shields.io/badge/Language-C%23-239120?logo=csharp)](https://learn.microsoft.com/dotnet/csharp/)

## 📋 題目描述

一個整數 `x` 是**數值平衡的（Numerically Balanced）**，如果對於 `x` 中的每個數字 `d`，在 `x` 中恰好有 `d` 個該數字的出現次數。

給定一個整數 `n`，返回**嚴格大於 `n` 的最小數值平衡數**。

### 範例說明

**範例 1:**

```text
輸入: n = 1
輸出: 22
解釋: 22 是數值平衡的，因為：
     - 數字 2 出現了 2 次
```

**範例 2:**

```text
輸入: n = 1000
輸出: 1333
解釋: 1333 是數值平衡的，因為：
     - 數字 1 出現了 1 次
     - 數字 3 出現了 3 次
```

**範例 3:**

```text
輸入: n = 3000
輸出: 3133
解釋: 3133 是數值平衡的，因為：
     - 數字 1 出現了 1 次
     - 數字 3 出現了 3 次
```

### 限制條件

- `0 <= n <= 10^6`

## 🎯 問題核心

### 什麼是數值平衡數

數值平衡數必須滿足一個關鍵特性：**數字本身的值 = 該數字在整個數中出現的次數**

讓我們分析幾個例子：

| 數字 | 是否平衡 | 原因 |
|------|---------|------|
| 1 | ❌ | 數字 1 出現 1 次，但這不構成多位數的平衡（題目要求嚴格大於給定的數） |
| 22 | ✅ | 數字 2 出現 2 次 ✓ |
| 122 | ✅ | 數字 1 出現 1 次 ✓，數字 2 出現 2 次 ✓ |
| 333 | ✅ | 數字 3 出現 3 次 ✓ |
| 1333 | ✅ | 數字 1 出現 1 次 ✓，數字 3 出現 3 次 ✓ |
| 4444 | ✅ | 數字 4 出現 4 次 ✓ |
| 123 | ❌ | 數字 1 出現 1 次 ✓，數字 2 出現 1 次 ✗（應該出現 2 次），數字 3 出現 1 次 ✗（應該出現 3 次） |

## 🔍 解題思路

### 方法一：暴力枚舉（Brute Force）

**核心概念：** 從 `n+1` 開始逐一檢查每個數字，直到找到第一個數值平衡數。

**步驟：**

1. 從 `n + 1` 開始遍歷
2. 對每個數字，統計其各位數字的出現次數
3. 檢查是否滿足數值平衡的條件：
   - 每個出現的數字 `d`，其出現次數必須恰好等於 `d`
   - 如果數字 `d` 出現在數中，但出現次數不等於 `d`，則不平衡
4. 找到第一個平衡數即返回

**優點：**

- 實作簡單直觀
- 不需要複雜的數學推導

**缺點：**

- 時間複雜度較高，最壞情況需要檢查大量數字
- 當 `n` 很大時效率不佳

### 方法二：預先生成所有數值平衡數

**核心概念：** 觀察到數值平衡數的數量有限，可以預先生成所有可能的平衡數，然後用二分搜尋找到答案。

**關鍵觀察：**

1. **數值平衡數的稀缺性：** 在 `[1, 10^6]` 範圍內，數值平衡數非常少
2. **數字組合的限制：**
   - 數字 0 不能出現（0 出現 0 次沒有意義）
   - 數字 1-7 可能出現
   - 數字 8、9 基本不可能（需要至少 8 或 9 位數，超出範圍）
3. **位數限制：** 在 10^6 以內，最多 7 位數

**可能的數字組合：**

- 單一數字：`22`, `333`, `4444`, `55555`, `666666`
- 組合數字：`1333`, `3133`, `3313`, `3331`（數字 1 和 3 的組合）
- 更多組合：`122444`, `1224444` 等

**步驟：**

1. 使用排列組合生成所有可能的數值平衡數
2. 將這些數字排序存入列表
3. 對給定的 `n`，使用二分搜尋找到第一個大於 `n` 的數值平衡數

**優點：**

- 查詢速度極快 O(log k)，k 為平衡數的總數
- 適合多次查詢

**缺點：**

- 需要預處理時間
- 需要額外空間存儲

### 方法三：回溯法生成（Backtracking）

**核心概念：** 從 `n+1` 的位數開始，使用回溯法構造可能的數值平衡數。

**步驟：**

1. 確定目標數字的位數範圍
2. 對每個位數，使用回溯法嘗試構造數值平衡數：
   - 選擇數字 1-7
   - 確保每個數字出現的次數等於其值
   - 剪枝：如果當前構造的數字已經不可能平衡，提前終止
3. 找到第一個大於 `n` 的平衡數

**優點：**

- 不需要預先生成所有數字
- 可以提早終止搜尋

## 💡 破題關鍵

1. **理解數值平衡的定義：** 數字的值 = 出現次數
2. **觀察數字範圍：** 在 10^6 以內，平衡數非常稀少
3. **選擇合適的方法：**
   - 如果只需要解決一次，暴力枚舉即可
   - 如果需要多次查詢，預生成列表更優
4. **邊界條件：** 注意 n = 0 時的特殊情況
5. **優化方向：** 可以跳過明顯不可能平衡的數字（例如包含 0 的數字）

## 🎓 延伸思考

1. 如何證明在某個範圍內數值平衡數的上限？
2. 是否存在通用公式直接計算下一個平衡數？
3. 如果範圍擴大到 10^9，哪種方法最有效？
4. 如何優化檢查平衡的函式效能？

## 🔗 相關連結

- [LeetCode 題目連結](https://leetcode.com/problems/next-greater-numerically-balanced-number/)
- [LeetCode CN 題目連結](https://leetcode.cn/problems/next-greater-numerically-balanced-number/)

---

**Daily Question:** 2025-10-24
