# LeetCode 2081: Sum of k-Mirror Numbers

## 題目描述

一個 k-鏡像數是指一個正整數在十進位和 k 進位下都是回文數（正著讀和反著讀都一樣），且不能有前導零。

**範例：**

- 9 是一個 2-鏡像數，因為：
  - 十進位：9（回文）
  - 二進位：1001（回文）
- 4 不是 2-鏡像數，因為：
  - 十進位：4（回文）
  - 二進位：100（不是回文）

**目標：** 給定進位制基數 k 和數字 n，回傳最小的 n 個 k-鏡像數的總和。

## 📂 專案結構

```text
leetcode_2081/
├── .vscode/
│   ├── launch.json          # VS Code 偵錯設定
│   └── tasks.json          # 建構任務設定
├── leetcode_2081/
│   ├── Program.cs          # 主要程式碼
│   └── leetcode_2081.csproj # 專案檔案
├── leetcode_2081.sln       # 解決方案檔案
└── README.md              # 說明文件
```

## 🚀 使用方式

### 建構與執行

```bash
# 建構專案
dotnet build

# 執行程式
dotnet run
```

### VS Code 偵錯

1. 開啟專案資料夾
2. 按 F5 或使用偵錯選單
3. 程式會自動建構並開始偵錯

## 🧮 解法說明

### 方法一：逐步生成

**核心思路：**

1. 按位數遞增順序生成十進位回文數
2. 對每個十進位回文數檢查是否也是 k 進位回文數
3. 累計找到 n 個 k-鏡像數的總和

**時間複雜度：** O(生成的回文數數量 × k 進位轉換)
**空間複雜度：** O(100) - 用於存儲 k 進位數字

### 方法二：預計算 + 前綴和優化

**核心思路：**

1. 預先計算所有需要的 k-鏡像數（k=2到9）
2. 使用前綴和儲存累計總和
3. 查詢時直接回傳結果

**時間複雜度：** O(1) 查詢，O(預計算) 初始化
**空間複雜度：** O(MAX_N × 8) 存儲所有結果

## 📊 性能比較

測試環境：k=2, n=5

| 方法 | 執行時間 | 結果 |
|------|----------|------|
| 方法一（逐步生成） | ~155 ms | 25 |
| 方法二（預計算） | ~69 ms | 25 |

方法二在多次查詢場景下具有明顯優勢。

## 🔍 關鍵演算法

### 十進位回文數生成

```csharp
// 奇數長度：123 -> 12321
for (int t = i / 10; t > 0; t /= 10) {
    x = x * 10 + t % 10;
}

// 偶數長度：123 -> 123321  
for (int t = i; t > 0; t /= 10) {
    x = x * 10 + t % 10;
}
```

### k 進位回文數檢查

#### 方法一：雙指標比較

```csharp
// 轉換為 k 進位數字陣列後雙向比較
for (int i = 0, j = length; i < j; i++, j--) {
    if (digit[i] != digit[j]) return false;
}
```

#### 方法二：半數反轉優化

```csharp
// 只反轉一半數字，避免溢出
while (rev < x / k) {
    rev = rev * k + x % k;
    x /= k;
}
return rev == x || rev == x / k;
```

## 🎯 特殊處理

1. **前導零問題：** 如果數字能被 k 整除，在 k 進位下會以 0 結尾，不是有效回文數
2. **位數判斷：** 奇數/偶數長度回文數的生成方式不同
3. **性能優化：** 方法二使用前綴和避免重複計算

## 🛠 技術特色

- **完整中文註解：** 詳細的演算法說明和程式碼註解
- **雙重實作：** 提供兩種不同效率的解法
- **VS Code 整合：** 完整的建構和偵錯設定
- **性能測試：** 內建執行時間比較功能

## 📝 LeetCode 連結

- [英文題目](https://leetcode.com/problems/sum-of-k-mirror-numbers/description/?envType=daily-question&envId=2025-06-23)
- [中文題目](https://leetcode.cn/problems/sum-of-k-mirror-numbers/description/?envType=daily-question&envId=2025-06-23)

## 🏷 標籤

`回文數` `進位制轉換` `數學` `演算法優化` `C#` `.NET 8.0`
