# LeetCode 75. 颜色分類（Sort Colors）

## 題目描述

給定一個包含 0、1 和 2 的整數陣列 `nums`，請你原地對陣列進行排序，使得相同顏色的元素相鄰，並按照 0、1、2 的順序排列。
你必須在不使用內建 sort 函式的情況下完成這個問題。

- 題目連結：
  - [LeetCode 英文版](https://leetcode.com/problems/sort-colors/description/?envType=daily-question&envId=2025-05-17)
  - [LeetCode 中文版](https://leetcode.cn/problems/sort-colors/description/?envType=daily-question&envId=2025-05-17)

## 解題提示與方法

1. 可以使用氣泡排序、計數排序或雙指針（荷蘭國旗問題）等方法。
2. 本專案提供三種解法：
   - **SortColors**：無腦氣泡排序，程式碼簡單但效率較低。
   - **SortColors2**：計數排序，先計算 0、1、2 的個數再重建陣列，效率高且易懂。
   - **SortColors3**：雙指針法（荷蘭國旗問題），一次遍歷即可完成排序，效率最佳。

## 計數排序與雙指針法效能差異分析

針對本題，方法 2（計數排序）與方法 3（雙指針法）的效能差異可能不會非常明顯，但確實存在一些理論上和實務上的區別：

### 時間複雜度

- **方法 2（計數排序）**：時間複雜度為 O(n)，需要兩次遍歷 - 一次計數，一次重建陣列
- **方法 3（雙指針法）**：時間複雜度也是 O(n)，但只需要一次遍歷

### 空間複雜度

- **方法 2**：空間複雜度 O(1)，因為計數陣列大小固定為 3
- **方法 3**：空間複雜度 O(1)，只使用常數個額外變數

### 實際效能差異

在此特定問題（只有 0、1、2 三種元素）中，差異可能表現在：

1. **記憶體存取模式**：
   - 計數排序會有較多的記憶體存取，因為需要先計數再重建
   - 雙指針法進行原地交換，記憶體存取較為集中

2. **運算量**：
   - 計數排序的第二階段仍需要兩層 for 迴圈
   - 雙指針法有更多的條件判斷和複雜交換邏輯

3. **分支預測**：
   - 雙指針法含有多個條件分支，可能導致較多的分支預測失誤

### 總結

理論上，雙指針法可能略優於計數排序，主要原因是只需一次遍歷與更少的記憶體存取操作。但在實際的測試環境中，對於小型測試資料，這些差異可能被系統開銷掩蓋。若資料集較大，雙指針法的優勢才會更明顯。

對於此特定問題，兩種方法都是優秀的解法，選擇哪一種可能更多取決於程式碼的可讀性和維護性考量。

## 雙指針法（荷蘭國旗問題）詳解

雙指針法是本題最優解，運用三個指標實現一次遍歷完成排序：

### 核心概念

- **p0**：指向下一個應該放 0 的位置
- **p1**：指向下一個應該放 1 的位置
- **i**：當前遍歷索引

### 指標移動邏輯

- 當 `nums[i] == 0` 時，同時遞增 `p0++` 和 `p1++`：
  - 因為放入 0 後，0 的區域擴大一格，同時 1 的起始位置也必須後移一格
- 當 `nums[i] == 1` 時，只需 `p1++`：
  - 因為放入 1 後，只有 1 的區域擴大，0 的區域大小維持不變

### 特殊處理

- 當 `nums[i] == 0` 且 `p0 < p1` 時，需要額外處理：
  - 先與 p0 交換，再與 p1 交換，確保 1 的順序不被破壞
- 當 `nums[i] == 2` 時，不需特別處理，因為 2 會自然留在最後

這種方法確保了：0 始終位於陣列前段、1 位於中段、2 位於後段，實現高效的原地排序。

## 專案結構

- `Program.cs`：主程式與三種排序解法，皆含詳細註解與測試驗證。

## 執行方式

1. 使用 .NET 8.0 或相容環境。
2. 在專案目錄下執行：

   ```sh
   dotnet run --project leetcode_75/leetcode_75.csproj
   ```

## 測試與驗證

主程式會自動測試三種排序法，並印出排序前後的陣列與正確性：

```csharp
// 測試資料
int[] nums = { 2, 0, 2, 1, 1, 0 };
Program p = new Program();
p.SortColors(nums);
Console.WriteLine($"SortColors 排序後陣列: {string.Join(", ", nums)}");
// ...同理測試 SortColors2 與 SortColors3
```

## 輸出範例

```text
原始陣列: 2, 0, 2, 1, 1, 0
SortColors 排序後陣列: 0, 0, 1, 1, 2, 2
SortColors 排序正確: True

原始陣列: 2, 0, 2, 1, 1, 0
SortColors2 排序後陣列: 0, 0, 1, 1, 2, 2
SortColors2 排序正確: True

原始陣列: 2, 0, 2, 1, 1, 0
SortColors3 排序後陣列: 0, 0, 1, 1, 2, 2
SortColors3 排序正確: True
```

---

> 本專案僅用於學習與 LeetCode 題解參考，歡迎交流改進！
